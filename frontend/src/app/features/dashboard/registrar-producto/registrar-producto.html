<main>
  <section>
    <div class="container d-flex justify-content-center align-items-center min-vh-100">
       <div class="col-12 col-md-8 col-lg-6">
      <h2 class="text-center mb-4">Registrar Entrada de Inventario</h2>

      <form [formGroup]="entradaForm" class="formularioEntrada" (ngSubmit)="guardarEntrada()">

        <!-- Código de Producto -->
        <div class="mb-3">
          <label for="codigo_producto" class="form-label">Código de Producto:</label>
          <input
            formControlName="codigo_producto"
            type="number"
            class="form-control"
            id="codigo_producto"
            (blur)="codigo_producto?.markAsTouched()"
            [ngClass]="{'error': codigo_producto?.touched && codigo_producto?.invalid}"
          >
          @if (codigo_producto?.touched && codigo_producto?.invalid) {
            <div>
              @if (codigo_producto?.errors?.['required']) {
                <small>Campo Requerido</small>
              }
            </div>
          }
        </div>

        <!-- Categoría -->
        <div class="mb-3">
          <label for="categoria" class="form-label">Categoría:</label>
          <select
            formControlName="categoria"
            id="categoria"
            class="form-select"
            (blur)="categoria?.markAsTouched()"
            [ngClass]="{'is-invalid': categoria?.touched && categoria?.invalid}"
          >
            <option value="" disabled selected>-- Seleccione categoría --</option>
            @for (cat of categorias$ | async; track cat.id) {
              <option [value]="cat.nombre">{{cat.nombre}}</option>
            }
          </select>
          @if (categoria?.touched && categoria?.invalid) {
            <div>
              @if (categoria?.errors?.['required']) {
                <small>Campo Requerido</small>
              }
            </div>
          }
        </div>

        <!-- Cantidad -->
        <div class="mb-3">
          <label for="cantidad" class="form-label">Cantidad:</label>
          <input
            formControlName="cantidad"
            type="number"
            class="form-control"
            id="cantidad"
            (blur)="cantidad?.markAsTouched()"
            [ngClass]="{'is-invalid': cantidad?.touched && cantidad?.invalid}"
          >
          @if (cantidad?.touched && cantidad?.invalid) {
            <div>
              @if (cantidad?.errors?.['required']) {
                <small>Campo Requerido</small>
              }
              @if (cantidad?.errors?.['min']) {
                <small>La cantidad debe ser 1 o mayor</small>
              }
            </div>
          }
        </div>

        <!-- Ubicación -->
        <div class="mb-3">
          <label for="ubicacion" class="form-label">Ubicación:</label>
          <input
            formControlName="ubicacion"
            type="text"
            class="form-control"
            id="ubicacion"
            (blur)="primeraLetraMayuscula('ubicacion')"
          >
        </div>

        <!-- Observaciones -->
        <div class="mb-3">
          <label for="observaciones" class="form-label">Observaciones:</label>
          <textarea
            formControlName="observaciones"
            id="observaciones"
            class="form-control"
            rows="4"
            placeholder="Ingrese observaciones o detalles adicionales..."
          ></textarea>
        </div>

        <!-- Botones -->
        <div class="d-flex flex-wrap w-100 gap-2">
          <button type="submit" class="btn-dashboard">
            Registrar Entrada
          </button>
          <button type="button" (click)="cancelarFormulario()" class="btn-dashboard">
            Cancelar
          </button>
          <button [routerLink]="'/dashboard'" type="button" class="btn-dashboard salir-btn ms-auto">
            Salir
          </button>
        </div>
      </form>

      @if (mensaje) {
        <div class="mensaje">
          <p>{{mensaje}}</p>
        </div>
      }

    </div></div>
  </section>
</main>
